<!DOCTYPE html>
<html lang="en">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="">
  <meta name="author" content="">
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:100,200,300,400,500,600,700,800,900" rel="stylesheet">

  <title>AWS WebSocket Tester</title>

  <!-- Bootstrap core CSS -->
  <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

  <!-- Additional CSS Files -->
  <link rel="stylesheet" href="assets/css/fontawesome.css">
  <link rel="stylesheet" href="assets/css/templatemo-eduwell-style.css">
  <link rel="stylesheet" href="assets/css/owl.css">
  <link rel="stylesheet" href="assets/css/lightbox.css">

</head>

<body>


  <!-- ***** Main Banner Area Start ***** -->
  <section class="main-banner" id="top">
    <div class="container">
      <div class="row">
        <div class="col-lg-5 align-self-center">
          <div class="header-text">

            <h2><em>Messenger</em></h2>

            <div class="row">
              <div class="col-md-9">
                <div class="input-group mb-3">
                  <input type="text" class="form-control" placeholder="Enter your name" id="username"
                    aria-label="Enter your name" aria-describedby="button-addon2">

                  <button class="btn btn-outline-secondary main-button-gradient" type="button"
                    id="username_submit">Submit</button>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="col-lg-7 p-5" id="messages">

        </div>
      </div>
    </div>
  </section>



  <!-- Scripts -->
  <!-- Bootstrap core JavaScript -->
  <script src="vendor/jquery/jquery.min.js"></script>
  <script src="vendor/bootstrap/js/bootstrap.min.js"></script>
  <script src="assets/js/isotope.min.js"></script>
  <script src="assets/js/owl-carousel.js"></script>
  <script src="assets/js/lightbox.js"></script>
  <script src="assets/js/tabs.js"></script>
  <script src="assets/js/video.js"></script>
  <script src="assets/js/slick-slider.js"></script>
  <script src="assets/js/custom.js"></script>
  <script>
    //according to loftblog tut
    $('.nav li:first').addClass('active');

    var showSection = function showSection(section, isAnimate) {
      var
        direction = section.replace(/#/, ''),
        reqSection = $('.section').filter('[data-section="' + direction + '"]'),
        reqSectionPos = reqSection.offset().top - 0;

      if (isAnimate) {
        $('body, html').animate({
          scrollTop: reqSectionPos
        },
          800);
      } else {
        $('body, html').scrollTop(reqSectionPos);
      }

    };

    var checkSection = function checkSection() {
      $('.section').each(function () {
        var
          $this = $(this),
          topEdge = $this.offset().top - 80,
          bottomEdge = topEdge + $this.height(),
          wScroll = $(window).scrollTop();
        if (topEdge < wScroll && bottomEdge > wScroll) {
          var
            currentId = $this.data('section'),
            reqLink = $('a').filter('[href*=\\#' + currentId + ']');
          reqLink.closest('li').addClass('active').
            siblings().removeClass('active');
        }
      });
    };

    $('.main-menu, .responsive-menu, .scroll-to-section').on('click', 'a', function (e) {
      e.preventDefault();
      showSection($(this).attr('href'), true);
    });

    $(window).scroll(function () {
      checkSection();
    });
  </script>

  <!-- Web Socket -->
  <script>
    function start(websocketServerLocation) {
      ws = new WebSocket(websocketServerLocation);
      ws.onmessage = function (evt) {
        //alert(event.data); 
        $('#messages').append('<h2>' + event.data + '</h2>');
      };
      ws.onopen = function () {
        console.log('WebSocket connection opened:', event);
      };
      ws.onclose = function () {
        console.log('WebSocket connection closed:', event);
        // Try to reconnect in 5 seconds
        setTimeout(function () { start(websocketServerLocation) }, 5000);
      };
    }

    $("#username_submit").click(function () {
      var username = $('#username').val();
      if (username) {
        $("#username_submit").attr("disabled", true);
        $("#username").attr("disabled", true);

        var websocketServerLocation = "wss://7ytbgidipk.execute-api.us-east-1.amazonaws.com/develop?key=xcvsdf&user=" + username;
        start(websocketServerLocation);
      }
    });

    // const socket = new WebSocket('wss://irkzageyzg.execute-api.us-east-1.amazonaws.com/develop?key=xcvsdf&user=shafeeque');
    // socket.addEventListener('open', (event) => {
    //   console.log('WebSocket connection opened:', event);
    // });

    // socket.addEventListener('message', (event) => {
    //   // Handle the received notification, e.g., display it to the user
    //   alert(`Received Notification: ${event.data}`);
    // });

    // socket.addEventListener('close', (event) => {
    //   console.log('WebSocket connection closed:', event);
    // });

  </script>



</body>

</html>